# Quality detectors (качество входа)

Quality detectors — это “датчики”, которые следят за входным потоком и поднимают алерты.
Они **выключены по умолчанию**, чтобы не нагружать сервер.

## Где включать

### В UI

1. Откройте канал (**Edit stream**).
2. В **INPUT LIST** нажмите ⚙️ (Input settings) у нужного входа.
3. Откройте **Advanced → Quality detectors**.
4. Включите нужные датчики и нажмите **OK**, потом **Save**.

### Через параметры в URL (`#...`)

Параметры добавляются в конец адреса после `#`.
Пример:

```text
udp://239.0.0.1:1234#cc_limit=1&no_audio_on=5&stop_video=on
```

!!! tip "Важно"
    Stream Hub сохраняет часть после `#`. Копируйте адрес полностью.

## Что происходит при срабатывании

Когда датчик видит проблему, он:

- меняет состояние в статусе канала (в Analyze/Status),
- добавляет запись в **Alerts**,
- и, если включены уведомления (например Telegram), отправляет сообщение туда.

Когда проблема исчезает, датчик отправляет событие “OK” (закрытие).

## Датчики

### CC errors limit

Считает CC‑ошибки (continuity counter) и сравнивает с лимитом.
Полезно, когда есть потери/дубликаты TS пакетов.

Пример:

```text
udp://239.0.0.1:1234#cc_limit=1
```

### No audio detection (cheap)

Дешёвый датчик “нет аудио”.
Он **не декодирует** звук. Он смотрит, что аудио PID/PTS двигается.

Параметр: `no_audio_on` (секунды).

```text
udp://239.0.0.1:1234#no_audio_on=5
```

### Stop video detection (cheap)

Дешёвый датчик “видео остановилось”.
Тоже без декодирования: если видео PES/PTS не двигается дольше таймаута — алерт.

```text
udp://239.0.0.1:1234#stop_video=on
```

### Detect AV desync

Смотрит рассинхрон аудио/видео по PTS.

Базовый вариант:

```text
udp://239.0.0.1:1234#detect_av=on
```

Если в UI есть поля threshold/hold/stable — лучше задавать их там (так меньше ошибиться).

### Silence detect (ffmpeg probe)

Датчик “тишина” по уровню (dB).
Он может запускать отдельный ffmpeg‑probe, поэтому это **самый дорогой** датчик.

Включайте, только если реально нужно.

## Как проверить, что датчики работают

1. Откройте **Analyze** по каналу.
2. Найдите блок `health` / “Quality detectors”.
3. Сымитируйте проблему (например отключите аудио) и посмотрите, что появился alert.

