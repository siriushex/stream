# Транскодирование

Транскодирование нужно, если вы хотите изменить качество, разрешение или битрейт.

!!! warning "Нагрузка"
    Транскодирование грузит CPU/GPU. Не включайте его “везде”, если сервер слабый.

## Что нужно

- В системе должен быть установлен `ffmpeg`.

Проверка:

```bash
ffmpeg -version
```

## Как включить

1. Откройте канал (Edit stream).
2. В блоке **Transcoding** включите **Enable transcoding**.
3. Перейдите на вкладку **Transcode** и выберите пресет.
4. Нажмите **Save**.

## Один профиль и “ladder” (multi‑bitrate)

В простом режиме у вас один профиль (одно качество).
Это удобно для UDP/HTTP‑TS “как есть, но перекодировано”.

Multi‑bitrate (ladder) — это несколько профилей сразу (например 720p/540p/360p).
Он нужен, когда вы хотите:

- HLS/DASH с несколькими вариантами качества,
- разные выходы на разном качестве,
- более стабильное воспроизведение у клиентов с “плавающим” интернетом.

## PNG to Stream (резервный TS из картинки)

Функция для генерации короткого MPEG‑TS файла из PNG.
Полезно как резервный вход (заставка + звук).

Где включается:

1. **Edit stream → Transcode**
2. Блок **PNG to Stream**
3. Выберите PNG, тип звука (тишина/писк/MP3) и нажмите **Generate TS**

После генерации вы получите файл `.ts`, который можно использовать
как резервный вход на вкладке **Backup**.

!!! tip "Совет"
    Лучше генерировать TS с параметрами основного потока (кодек/разрешение/FPS).
    Для этого используйте кнопку **Analyze main stream** в блоке PNG to Stream.

## Create radio (аудио + PNG → UDP TS)

Функция для радио‑каналов: аудио поток + статичная картинка,
на выходе — MPEG‑TS по UDP.

Где включается:

1. **Edit stream → Transcode**
2. Блок **Create radio**
3. Укажите Audio URL, PNG, UDP‑адрес и нажмите **Start**

Доступно управление **Start / Stop / Restart** и логи запуска.

## Если не запускается

- Проверьте логи сервиса.
- Убедитесь, что `ffmpeg` доступен в `PATH`.

## Если ffmpeg падает и не поднимается

1. Откройте **Log** и найдите строку про ffmpeg (обычно видно причину).
2. Проверьте вход: ONLINE и битрейт > 0.
3. Проверьте, что хватает ресурсов (CPU/RAM, место на диске).
4. Если включён push (RTMP/RTSP/DASH) — проверьте сеть и доступность удалённой стороны.
